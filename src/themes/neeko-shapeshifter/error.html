<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Error</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: #0a2540;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #ffffff;
            overflow: hidden;
            position: relative;
        }

        .neeko-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
            opacity: 0.85;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg,
                rgba(138, 218, 203, 0.2),
                rgba(221, 126, 227, 0.2),
                rgba(255, 191, 105, 0.2));
            z-index: 1;
        }

        .content-container {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 40px;
            max-width: 750px;
            width: 90%;
        }

        .error-card {
            background: linear-gradient(135deg,
                rgba(138, 218, 203, 0.95),
                rgba(221, 126, 227, 0.95));
            border-radius: 30px;
            padding: 50px 40px;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.5),
                        0 0 60px rgba(138, 218, 203, 0.3);
            position: relative;
            overflow: hidden;
        }

        .error-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .chameleon-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 2s ease-in-out infinite;
            display: inline-block;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-15px) scale(1.1); }
        }

        .error-code {
            font-size: 90px;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            background: linear-gradient(135deg, #ff6b9d, #c471ed, #12c2e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            line-height: 1;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            animation: colorShift 4s ease-in-out infinite;
        }

        @keyframes colorShift {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(30deg); }
        }

        .error-title {
            font-size: 32px;
            font-weight: 600;
            font-family: 'Fredoka', sans-serif;
            color: #0a2540;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3);
        }

        .neeko-text {
            font-size: 19px;
            color: #1a3a5a;
            line-height: 1.7;
            margin-bottom: 30px;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.6);
            padding: 20px;
            border-radius: 15px;
        }

        .shape-status {
            display: inline-block;
            padding: 10px 25px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            margin: 15px 0 25px;
            font-size: 15px;
            color: #0a2540;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn {
            display: inline-block;
            padding: 15px 35px;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            border-radius: 50px;
            transition: all 0.3s ease;
            font-family: 'Fredoka', sans-serif;
            text-transform: capitalize;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff6b9d, #c471ed);
            color: #ffffff;
            box-shadow: 0 8px 25px rgba(196, 113, 237, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 35px rgba(196, 113, 237, 0.6);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.9);
            color: #c471ed;
            border: 2px solid #c471ed;
        }

        .btn-secondary:hover {
            background: #ffffff;
            transform: translateY(-3px) scale(1.05);
        }

        .footer-text {
            margin-top: 25px;
            font-size: 14px;
            color: rgba(10, 37, 64, 0.8);
            font-weight: 500;
            font-style: italic;
        }

        .sparkle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px #fff, 0 0 20px #8adacb;
            animation: sparkle 2s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes sparkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @media (max-width: 768px) {
            .error-card {
                padding: 40px 30px;
            }

            .error-code {
                font-size: 70px;
            }

            .error-title {
                font-size: 26px;
            }

            .neeko-text {
                font-size: 17px;
            }

            .chameleon-icon {
                font-size: 60px;
            }
        }
    </style>
</head>
<body>
    <img src="resources/neeko.png" alt="Neeko" class="neeko-bg">
    <div class="overlay"></div>

    <div class="content-container">
        <div class="error-card">
            <div class="chameleon-icon">ðŸ¦Ž</div>
            <div class="error-code" id="error-code">404</div>
            <div class="error-title" id="error-title">Neeko Cannot Find Page!</div>
            <div class="neeko-text" id="neeko-text">
                Neeko tried to be this page, but Neeko is not good enough shapeshifter yet! Neeko is strong tomato, not sad tomato. Maybe try different page?
            </div>
            <div class="shape-status" id="shape-status">
                ðŸŽ­ Shapeshifting: Failed
            </div>
            <div class="buttons">
                <a href="/" class="btn btn-primary">Find Real Page</a>
                <a href="javascript:void(0)" onclick="goBack(); return false;" class="btn btn-secondary">Go Back</a>
            </div>
            <div class="footer-text" id="footer-text">
                Neeko is best decision!
            </div>
        </div>
    </div>

    <script>
        function goBack() {
            // Check for ref query parameter (passed from random error page)
            const urlParams = new URLSearchParams(window.location.search);
            const refParam = urlParams.get('ref');
            
            if (refParam && refParam !== window.location.href) {
                window.location.href = decodeURIComponent(refParam);
            } else if (document.referrer && document.referrer !== window.location.href) {
                window.location.href = document.referrer;
            } else {
                window.location.href = '/';
            }
        }

        const errorMessages = {
            400: "Bad Request",
            401: "Unauthorized",
            402: "Payment Required",
            403: "Forbidden",
            404: "Not Found",
            405: "Method Not Allowed",
            406: "Not Acceptable",
            408: "Request Timeout",
            409: "Conflict",
            410: "Gone",
            413: "Payload Too Large",
            429: "Too Many Requests",
            500: "Internal Server Error",
            502: "Bad Gateway",
            503: "Service Unavailable",
            504: "Gateway Timeout"
        };

        const titles = {
            400: "Neeko Cannot Understand!",
            401: "Neeko Needs Permission!",
            402: "Neeko Needs Payment!",
            403: "Neeko Not Allowed Here!",
            404: "Neeko Cannot Find Page!",
            405: "Neeko Used Wrong Method!",
            406: "Neeko Cannot Accept!",
            408: "Neeko Waited Too Long!",
            409: "Neeko Found Conflict!",
            410: "Page Gone Forever!",
            413: "Too Big For Neeko!",
            429: "Neeko Trying Too Fast!",
            500: "Server Broken!",
            502: "Gateway Confused Neeko!",
            503: "Service Resting!",
            504: "Gateway Too Slow!"
        };

        const neekoTexts = {
            400: "Neeko tried to understand request, but it makes Neeko confused! Like trying to shapeshift into cloud. Please make request clearer for Neeko!",
            401: "Neeko needs you to show who you are first! Even Neeko can't pretend to be someone without knowing them. Please log in!",
            402: "This page costs money, and Neeko has no shoma! Neeko is sad tomato now. Maybe find payment method?",
            403: "This place is forbidden for Neeko! Neeko tried to sneak in as different person but they saw through disguise. Neeko is not allowed here.",
            404: "Neeko tried to be this page, but Neeko is not good enough shapeshifter yet! Neeko is strong tomato, not sad tomato. Maybe try different page?",
            405: "Neeko used wrong approach! Like trying to swim on land. This method doesn't work here, Neeko needs different way!",
            406: "Server says 'no' to format Neeko brings! Like Neeko bringing wrong berries to feast. Try different format, yes?",
            408: "Neeko waited and waited but nothing happened! Neeko got bored and fell asleep. Request took too long for strong tomato like Neeko!",
            409: "Two things fighting for same spot! Like when Neeko tries to be two people at once. Creates big confusion! Try again maybe?",
            410: "Page is gone forever, like old friend who moved away. Neeko cannot shapeshift into something that doesn't exist anymore. Neeko is sad.",
            413: "Request too big for Neeko to carry! Neeko is strong tomato but not THAT strong. Please make smaller, yes?",
            429: "Slow down! Neeko can't shapeshift that fast! Too many requests makes Neeko dizzy. Take break, strong tomato needs rest!",
            500: "Oh no! Server is broken and Neeko cannot fix! Neeko tried to shapeshift into working server but failed. Someone else must fix this!",
            502: "Gateway is acting strange and Neeko is confused! Like trying to talk to someone who speaks weird language. Gateway broken!",
            503: "Service is taking nap right now. Even Neeko needs rest sometimes! Come back later when service wakes up, yes?",
            504: "Gateway is too slow for Neeko! Neeko waited and waited but gateway never responded. Neeko's patience ran out!"
        };

        const shapeStatuses = {
            400: "ðŸŽ­ Shapeshifting: Confused",
            401: "ðŸŽ­ Shapeshifting: Need Identity",
            402: "ðŸŽ­ Shapeshifting: Need Shoma",
            403: "ðŸŽ­ Shapeshifting: Forbidden",
            404: "ðŸŽ­ Shapeshifting: Failed",
            405: "ðŸŽ­ Shapeshifting: Wrong Method",
            406: "ðŸŽ­ Shapeshifting: Rejected",
            408: "ðŸŽ­ Shapeshifting: Timed Out",
            409: "ðŸŽ­ Shapeshifting: Conflicted",
            410: "ðŸŽ­ Shapeshifting: Target Gone",
            413: "ðŸŽ­ Shapeshifting: Too Heavy",
            429: "ðŸŽ­ Shapeshifting: Too Fast",
            500: "ðŸŽ­ Shapeshifting: System Error",
            502: "ðŸŽ­ Shapeshifting: Gateway Error",
            503: "ðŸŽ­ Shapeshifting: Service Sleeping",
            504: "ðŸŽ­ Shapeshifting: Gateway Slow"
        };

        const footerTexts = {
            400: "Neeko learns from mistakes!",
            401: "Neeko respects privacy!",
            402: "Neeko understands value!",
            403: "Neeko respects boundaries!",
            404: "Neeko is best decision!",
            405: "Neeko adapts to situation!",
            406: "Neeko tries different way!",
            408: "Patience is not Neeko's strength!",
            409: "Neeko avoids conflict when possible!",
            410: "Neeko moves forward!",
            413: "Neeko knows her limits!",
            429: "Slow and steady wins race!",
            500: "Not Neeko's fault this time!",
            502: "Gateway makes Neeko confused!",
            503: "Everyone needs rest, even servers!",
            504: "Neeko is faster than gateway!"
        };

        // Get error code from URL path
        const path = window.location.pathname;
        const match = path.match(/\/(\d+)\.html$/);
        const errorCode = match ? parseInt(match[1]) : 404;
        const errorMessage = errorMessages[errorCode] || "Unknown Error";
        const title = titles[errorCode] || "Neeko Found Problem!";
        const neekoText = neekoTexts[errorCode] || "Something went wrong but Neeko doesn't know what!";
        const shapeStatus = shapeStatuses[errorCode] || "ðŸŽ­ Shapeshifting: Unknown";
        const footerText = footerTexts[errorCode] || "Neeko tries her best!";

        // Update page content
        document.getElementById('error-code').textContent = errorCode;
        document.getElementById('error-title').textContent = title;
        document.getElementById('neeko-text').textContent = neekoText;
        document.getElementById('shape-status').textContent = shapeStatus;
        document.getElementById('footer-text').textContent = footerText;
        document.getElementById('page-title').textContent = errorCode + " - " + errorMessage;

        // Fix resource paths for internal error redirects
        const themeName = 'neeko-shapeshifter';
        document.querySelectorAll('img[src^="resources/"]').forEach(img => {
            img.src = '/fairer-pages/' + themeName + '/' + img.getAttribute('src');
        });

        // Create sparkles
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle');
            sparkle.style.left = Math.random() * 100 + 'vw';
            sparkle.style.top = Math.random() * 100 + 'vh';
            sparkle.style.animationDelay = Math.random() * 2 + 's';
            document.body.appendChild(sparkle);

            setTimeout(() => {
                sparkle.remove();
            }, 2000);
        }

        // Generate sparkles periodically
        setInterval(createSparkle, 500);
    </script>
</body>
</html>
